# Is to be executed from the main makefile

CLOUD_MAPS_SYMBOL=cloud_maps
CLOUD_MAPS_PATH=$(BLDPATH)/cloud_maps
CLOUD_MAPS_AS=$(CLOUD_MAPS_PATH)/cloud_maps.s
CLOUD_MAPS_OBJ=$(CLOUD_MAPS_PATH)/cloud_maps.o
CLOUD_MAPS_INTERMEDIATE=$(CLOUD_MAPS_PATH)/cloud_maps.i
CLOUD_MAPS_DEPENDENCY=$(CLOUD_MAPS_PATH)/cloud_maps.d
CLOUD_MAPS_EXPORT=tools/cloud_maps/export.py

$(CLOUD_MAPS_AS): $(MAPPROJ)
	$(shell mkdir -p $(dir $@))
	$(CLOUD_MAPS_EXPORT) $(MAPPROJ) $(CLOUD_MAPS_AS) $(CLOUD_MAPS_SYMBOL)

$(CLOUD_MAPS_OBJ): $(CLOUD_MAPS_AS)
	$(PYPREPROC) -o $(CLOUD_MAPS_INTERMEDIATE) $(CLOUD_MAPS_AS) $(MAPPROJ)
	$(AS) $(ASFLAGS) --MD $(CLOUD_MAPS_DEPENDENCY) $(CLOUD_MAPS_INTERMEDIATE) -o $(CLOUD_MAPS_OBJ)
